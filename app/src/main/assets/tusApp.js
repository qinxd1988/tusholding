var tusApp=tusApp||{};!function(a){function b(a,b){(f[a]||(f[a]=[])).push(b);var g=c?c[a]:{},h=g.pkg?d[g.pkg].url:g.url||a;if(!(h in i)){i[h]=!0;var j=document.createElement("script");j.type="text/javascript",j.src=h,e.appendChild(j)}}var c,d,e=document.getElementsByTagName("head")[0],f={},g={},h={},i={};tusApp.define=function(a,b){g[a]=b;var c=f[a];if(c){for(var d=c.length-1;d>=0;--d)c[d]();delete f[a]}},tusApp.require=function(a){a=tusApp.require.alias(a);var b=h[a];if(b)return b.exports;var c=g[a];if(!c)throw Error("Cannot find module `"+a+"`");b=h[a]={exports:{}};var d="function"==typeof c?c.apply(b,[tusApp.require,b.exports,b]):c;return d&&(b.exports=d),b.exports},tusApp.require.async=function(d,e){function f(a){for(var d=a.length-1;d>=0;--d){var e=a[d];if(!(e in g||e in j)){j[e]=!0,k++,b(e,h);var i=c&&c[e];i&&"deps"in i&&f(i.deps)}}}function h(){if(0==k--){var b,c,f=[];for(b=0,c=d.length;b<c;++b)f[b]=tusApp.require(d[b]);e&&e.apply(a,f)}}"string"==typeof d&&(d=[d]);for(var i=d.length-1;i>=0;--i)d[i]=tusApp.require.alias(d[i]);var j={},k=0;f(d),h()},tusApp.require.resourceMap=function(a){c=a.res||{},d=a.pkg||{}},tusApp.require.alias=function(a){return a}}(this),tusApp.define("core/util.js",function(a,b,c){var d={};c.exports={joinParams:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c+"="+a[c]);return b.join("&")},isString:function(a){return"string"==typeof a},isFunction:function(a){return"function"==typeof a},cache:function(a,b){if(void 0===b)return d[a];d[a]=b}}}),tusApp.define("core/event.js",function(a,b,c){function d(a,b,c){(a||"").split(j).forEach(function(a){c(a,b)})}function e(a){return new RegExp("(?:^| )"+a.replace(" "," .* ?")+"(?: |$)")}function f(a){var b=(""+a).split(".");return{e:b[0],ns:b.slice(1).sort().join(" ")}}function g(a,b,c,d){var g,h;return h=f(b),h.ns&&(g=e(h.ns)),a.filter(function(a){return a&&(!h.e||a.e===h.e)&&(!h.ns||g.test(a.ns))&&(!c||a.cb===c||a.cb._cb===c)&&(!d||a.ctx===d)})}function h(a,b){return this instanceof h?(b&&$.extend(this,b),this.type=a,this):new h(a,b)}var i=[].slice,j=/\s+/,k=function(){return!1},l=function(){return!0};h.prototype={isDefaultPrevented:k,isPropagationStopped:k,preventDefault:function(){this.isDefaultPrevented=l},stopPropagation:function(){this.isPropagationStopped=l}},c.exports={on:function(a,b,c){var e,g=this;return b?(e=this._events||(this._events=[]),d(a,b,function(a,b){var d=f(a);d.cb=b,d.ctx=c,d.ctx2=c||g,d.id=e.length,e.push(d)}),this):this},one:function(a,b,c){var e=this;return b?(d(a,b,function(a,b){var d=function(){return e.off(a,d),b.apply(c||e,arguments)};d._cb=b,e.on(a,d,c)}),this):this},off:function(a,b,c){var e=this._events;return e?a||b||c?(d(a,b,function(a,b){g(e,a,b,c).forEach(function(a){delete e[a.id]})}),this):(this._events=[],this):this},trigger:function(a){var b,c,d,e,f,j=-1;if(!this._events||!a)return this;if("string"==typeof a&&(a=new h(a)),b=i.call(arguments,1),a.args=b,b.unshift(a),c=g(this._events,a.type))for(e=c.length;++j<e;)if((d=a.isPropagationStopped())||!1===(f=c[j]).cb.apply(f.ctx2,b)){d||(a.stopPropagation(),a.preventDefault());break}return this}}}),tusApp.define("core/listener.js",function(a,b,c){var d={},e={};c.exports={getListeners:function(){return d||{}},getObservers:function(){return e||{}},addObserver:function(a,b){a&&"function"==typeof b&&"function"==typeof b&&(e[a]=function(a){return b.call(null,a?JSON.parse(a):"")})},addListener:function(a,b){a&&"function"==typeof b&&(d[a]="function"==typeof b?function(a){return b.call(null,a?JSON.parse(a):"")}:function(b){return console.log(JSON.stringify({fnName:a,return:-1})),-1})},removeListener:function(a){a&&d[a]&&delete d[a]},removeObserver:function(a){a&&e[a]&&delete e[a]}}}),tusApp.define("core/base64.js",function(a,b,c){!function(b){"use strict";var d,e=b.Base64,f="2.1.9";if(void 0!==c&&c.exports)try{d=a("buffer").Buffer}catch(a){}var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=function(a){for(var b={},c=0,d=a.length;c<d;c++)b[a.charAt(c)]=c;return b}(g),i=String.fromCharCode,j=function(a){if(a.length<2){var b=a.charCodeAt(0);return b<128?a:b<2048?i(192|b>>>6)+i(128|63&b):i(224|b>>>12&15)+i(128|b>>>6&63)+i(128|63&b)}var b=65536+1024*(a.charCodeAt(0)-55296)+(a.charCodeAt(1)-56320);return i(240|b>>>18&7)+i(128|b>>>12&63)+i(128|b>>>6&63)+i(128|63&b)},k=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,l=function(a){return a.replace(k,j)},m=function(a){var b=[0,2,1][a.length%3],c=a.charCodeAt(0)<<16|(a.length>1?a.charCodeAt(1):0)<<8|(a.length>2?a.charCodeAt(2):0);return[g.charAt(c>>>18),g.charAt(c>>>12&63),b>=2?"=":g.charAt(c>>>6&63),b>=1?"=":g.charAt(63&c)].join("")},n=b.btoa?function(a){return b.btoa(a)}:function(a){return a.replace(/[\s\S]{1,3}/g,m)},o=d?function(a){return(a.constructor===d.constructor?a:new d(a)).toString("base64")}:function(a){return n(l(a))},p=function(a,b){return b?o(String(a)).replace(/[+\/]/g,function(a){return"+"==a?"-":"_"}).replace(/=/g,""):o(String(a))},q=function(a){return p(a,!0)},r=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),s=function(a){switch(a.length){case 4:var b=(7&a.charCodeAt(0))<<18|(63&a.charCodeAt(1))<<12|(63&a.charCodeAt(2))<<6|63&a.charCodeAt(3),c=b-65536;return i(55296+(c>>>10))+i(56320+(1023&c));case 3:return i((15&a.charCodeAt(0))<<12|(63&a.charCodeAt(1))<<6|63&a.charCodeAt(2));default:return i((31&a.charCodeAt(0))<<6|63&a.charCodeAt(1))}},t=function(a){return a.replace(r,s)},u=function(a){var b=a.length,c=b%4,d=(b>0?h[a.charAt(0)]<<18:0)|(b>1?h[a.charAt(1)]<<12:0)|(b>2?h[a.charAt(2)]<<6:0)|(b>3?h[a.charAt(3)]:0),e=[i(d>>>16),i(d>>>8&255),i(255&d)];return e.length-=[0,0,2,1][c],e.join("")},v=b.atob?function(a){return b.atob(a)}:function(a){return a.replace(/[\s\S]{1,4}/g,u)},w=d?function(a){return(a.constructor===d.constructor?a:new d(a,"base64")).toString()}:function(a){return t(v(a))},x=function(a){return w(String(a).replace(/[-_]/g,function(a){return"-"==a?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},y=function(){var a=b.Base64;return b.Base64=e,a};if(c.exports={VERSION:f,atob:v,btoa:n,fromBase64:x,toBase64:p,utob:l,encode:p,encodeURI:q,btou:t,decode:x,noConflict:y},b.Base64={VERSION:f,atob:v,btoa:n,fromBase64:x,toBase64:p,utob:l,encode:p,encodeURI:q,btou:t,decode:x,noConflict:y},"function"==typeof Object.defineProperty){var z=function(a){return{value:a,enumerable:!1,writable:!0,configurable:!0}};b.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",z(function(){return x(this)})),Object.defineProperty(String.prototype,"toBase64",z(function(a){return p(this,a)})),Object.defineProperty(String.prototype,"toBase64URI",z(function(){return p(this,!0)}))}}}(this)}),tusApp.define("bridge/jsBridge.js",function(a,b,c){function d(a){console.log(a);var b=document.createElement("iframe");b.setAttribute("src",a),b.style.display="none",document.body.appendChild(b),b.parentNode.removeChild(b),b=null}function e(){this.init()}function f(a,b){return a+"://"+b+"?"}function g(){return h||(h=window.document.createEvent("Event"),h.initEvent("tusAppReady",!0,!0)),h}var h,i=a("core/event.js"),j=a("core/util.js"),k=a("core/base64.js"),l=a("core/listener.js"),m={scheme:"bdwm",webHost:"websdk",nativeHost:"native",pluginHost:"plugin"},n={getCommand:function(a,b,c){return b&&b.pageParams&&b.pageParams.pageData&&(b.pageParams.pageData=JSON.stringify(b.pageParams.pageData)),f(m.scheme,m.webHost)+j.joinParams({action:a,params:encodeURIComponent(JSON.stringify(b)),callback:c})},getGlobalWebCommand:function(a){var b=a.pageParams,c=b?"&"+j.joinParams(b):"";return b&&!b.url?"":(a&&b&&b.pageData&&(b.pageData=JSON.stringify(b.pageData)),f(m.scheme,m.nativeHost)+j.joinParams({pageName:"webview"})+c)},getGlobalAppCommand:function(a){var b,c=a.pageName,d=a.pageParams;return c?(a&&d&&d.pageData&&(d.pageData=JSON.stringify(d.pageData)),b=d?"&"+j.joinParams(d):"",f(m.scheme,m.nativeHost)+j.joinParams({pageName:c})+b):""},getGlobalPluginCommand:function(a){var b,c=a.pluginId,d=a.pageName,e=a.pageParams;return d?(a&&e&&e.pageData&&(e.pageData=JSON.stringify(e.pageData)),b=e?"&"+j.joinParams(e):"",f(m.scheme,m.pluginHost)+j.joinParams({pluginId:c,pageName:d})+b):""}},o=function(a){var b=a;return{notify:function(a,c){var d=null;c&&(d=k.decode(c)),a&&b.onReceiveMessage(a,d&&JSON.parse(d))},notifyWithoutParse:function(a,c){a&&b.onReceiveMessage(a,c)},notifyListener:function(a,b){var c,d=null,e=l.getListeners()&&l.getListeners()[a];return b&&(d=k.decode(b)),"function"==typeof e?(c=e(d),console.log(JSON.stringify({fnName:a,return:c})),c):(console.log(JSON.stringify({fnName:a,return:-1})),-1)},notifyObserver:function(a,b){var c,d=null,e=l.getObservers()&&l.getObservers()[a];if(b&&(d=k.decode(b)),"function"==typeof e)return c=e(d),console.log(JSON.stringify({fnName:a,return:c})),c},initReadyEvent:function(a){var b=g(),c=null;a&&(c=k.decode(a)),c&&(b.pageData=JSON.parse(c)),window.document.dispatchEvent(b)},initData:function(a){var b=null,c=null;try{a&&(c=k.decode(a),(b=JSON.parse(c))&&j.cache("tusAppData",b))}catch(a){console.log(a)}},setScheme:function(a){a&&(m.scheme=a)}}};e.prototype={constructor:e,init:function(){window.tusAppBridge=o(this)||{}},sendNotifyRequest:function(a,b,c,e){var f="";"websdk"==a?f=n.getCommand(b,c,e):"globalweb"==a?f=n.getGlobalWebCommand(c):"globalapp"==a?f=n.getGlobalAppCommand(c):"globalplugin"==a&&(f=n.getGlobalPluginCommand(c)),d(f)},onReceiveMessage:function(a,b){i.trigger(a,b)}},c.exports=e}),tusApp.define("bridge/kernel.js",function(a,b,c){function d(a){return"wm_event_"+a+"_"+l++}function e(a,b,c,e){var g=d(b),i=e,j=c;f.isFunction(c)&&(i=c,j={}),f.isFunction(i)&&h.on(g,function(a){var b;a&&a.args&&(b=a.args.slice(1)),i.apply(null,b),h.off(g,arguments.callee)}),setTimeout(function(){k.sendNotifyRequest(a,b,j,g)},0)}var f=a("core/util.js"),g=a("bridge/jsBridge.js"),h=a("core/event.js"),i=a("core/listener.js"),j=a("core/util.js"),k=new g,l=0;c.exports={invoke:function(a,b,c){return e("websdk",a,b,c)},globalWebInvoke:function(a){return e("globalweb","native",a)},globalAppInvoke:function(a){return e("globalapp","native",a)},globalPluginInvoke:function(a){return e("globalplugin","plugin",a)},addListener:function(a,b){i.addListener(a,b)},removeListener:function(a){i.removeListener(a)},getInitData:function(){return j.cache("tusAppData")}}}),tusApp.define("tusApi/nui.js",function(a,b,c){var d=a("bridge/kernel.js");c.exports={toast:function(a){a.text&&d.invoke("toast",a)},dialog:function(a,b){a.content&&d.invoke("dialog",a,b)},loading:function(a){d.invoke("loading",a)}}}),tusApp.define("tusApi/photo.js",function(a,b,c){var d=a("bridge/kernel.js");c.exports={takePhoto:function(a){d.invoke("takePhoto",a)}}}),tusApp.define("tusApi/network.js",function(a,b,c){function d(a,b){return a+(a.indexOf("?")>-1?"&":"?")+(b?g.joinParams(b):"")}function e(a,b){return"function"==typeof a?function(c){c.settings=b,c.result&&c.result.responseBody&&(c.result.responseBody=decodeURIComponent(c.result.responseBody)),c.result&&c.result.responseHeaders&&(c.result.responseHeaders=decodeURIComponent(c.result.responseHeaders)),a.call(null,c)}:function(){}}var f=a("bridge/kernel.js"),g=a("core/util.js");c.exports={getNetwork:function(a){f.invoke("getNetwork",a)},getRequest:function(a,b){var c={};a&&a.url&&(c.type="GET",c.url=d(a.url,a.data),a.header&&(c.header=a.header),f.invoke("sendRequest",c,e(b,a)))},postRequest:function(a,b){var c={};a&&a.url&&(c.type="POST",c.url=a.url,c.contentType="application/x-www-form-urlencoded",a.data&&(c.rawData=g.joinParams(a.data)),a.header&&(c.header=a.header),f.invoke("sendRequest",c,e(b,a)))},postRawRequest:function(a,b){var c={};a&&a.url&&(c.type="POST",c.url=a.url,c.contentType=a.contentType||"application/x-www-form-urlencoded",c.rawData=a.data,a.header&&(c.header=a.header),f.invoke("sendRequest",c,e(b,a)))},downloadPKG:function(a){a.pluginId&&a.url&&f.invoke("downloadPKG",a)}}}),function(a){var b=a.tusApp,c=a.tusApp.require;a.tusAppBridge||(b.nui=c("tusApi/nui.js"),b.photo=c("tusApi/photo.js"),b.network=c("tusApi/network.js"),b.kernel=c("bridge/kernel.js"),b.jsBridge=c("bridge/jsBridge.js"),b.event=c("core/event.js"),console.log("tusAppReady"))}(window);